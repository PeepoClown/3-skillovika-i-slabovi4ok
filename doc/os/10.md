## 10. Виртуальная память. Сегментная организация виртуальной памяти; преобразование адресов; организация таблиц сегментов. Сегментно-страничная организация: преобразование адресов, особенности реализации. Коллективное использование информации и защита информации для страничной, сегментной и сегментно-страничной организации памяти.

Сегментная организация виртуальной памяти предполагает разделение программы на логически законченные части - сегменты, которые становятся единицами
манипулирования при реализации механизма виртуальной памяти. Отдельный сегмент может представлять собой подпрограмму, массив данных и т. п.
Это позволяет разделять доступ к памяти для различных сегментов, например разрешить только чтение сегменту данных или запретить любые операции
с сегментом кода программы. Также можно загрузить в память участок кода, требуемый нескольким программам, в одном экземпляре.

При загрузке процесса часть сегментов помещается в оперативную память, при этом для каждого из этих сегментов операционная система подыскивает
подходящий участок свободной памяти, а часть сегментов размещается в дисковой памяти. Сегменты одной программы могут занимать в оперативной памяти
несмежные участки. Во время загрузки система создаёт таблицу сегментов процесса (аналогичную таблице страниц), в которой для каждого сегмента указывается
начальный физический адрес сегмента в оперативной памяти, размер сегмента, правила доступа, признак модификации, признак обращения к данному сегменту за
последний интервал времени и некоторая другая информация. Если виртуальные адресные пространства нескольких процессов включают один и тот же сегмент,
то в таблицах сегментов этих процессов делаются ссылки на один и тот же участок оперативной памяти, в который данный сегмент загружается в единственном экземпляре.

Виртуальный адрес при сегментной организации памяти может быть представлен парой (s,d), где s — номер сегмента, d — смещение в сегменте.
Физический адрес получается путём сложения начального физического адреса сегмента S, найденного в таблице сегментов по номеру s, и смещения d.

Способы организации таблиц сегментов

1. Единая таблица
Одна единая таблица, которая содержит все дескрипторы сегментов и выполняемых программ, при этом у каждого такого сегмента в системе существует одно
единственное имя, которое и является идентификатором дескриптора таблицы. В этом случае такой дескриптор должен содержать список прав доступа для всех процесов
которые могут использовать данный сегмент. Такой список прав доступа может быть очень большим. Понятно, что такая система не является гибкой, все процессы
обращаются к сегменту по одному единственному его имени.

2. Локальная таблица
Локальные таблицы, то есть каждый процесс (его адресное пространство разбито на сегменты, соответственно, каждое такое локальное адресное пространство
имеет свою локальную таблицу дескрипторов. Для того чтобы другие процессы могли обратиться к этому же сегменту этот сегмент должен иметь дескриптор в
соответствующих локальный таблицах. То есть для того чтобы процесс смог обращаться к сегментам других программ, эти сегменты должны быть описаны в их
локальных таблицах, но при этом получается, что один сегмент в системе может иметь несколько разных имён. Это безусловно усложняет работу с сегментами в системе.

3. Локальные таблицы + глобальные таблицы
Локальные таблицы и глобальная таблица. При этом локальные таблицы описывают адресное пространство процессов, но дескрипторы этих локальных таблиц ссылаются на дескрипторы глобальной таблицы.

Странично-сегментная организация виртуальной памяти представляет собой комбинацию страничного и сегментного распределения памяти и, вследствие этого,
сочетает в себе достоинства обоих подходов. Виртуальное пространство процесса делится на сегменты, а каждый сегмент в свою очередь делится на виртуальные страницы,
которые нумеруются в пределах сегмента. Оперативная память делится на физические страницы равного размера, кратные степени двойки.

Загрузка процесса выполняется операционной системой постранично, при этом часть страниц размещается в оперативной памяти, а часть на диске. Для каждого сегмента
создаётся своя таблица страниц, структура которой полностью совпадает со структурой таблицы страниц, используемой при страничном распределении.
Для каждого процесса создаётся таблица сегментов, в которой указываются адреса таблиц страниц для всех сегментов данного процесса. Адрес таблицы сегментов
загружается в специальный регистр процессора, когда активизируется соответствующий процесс.

Виртуальный адрес в такой системе представляет собой тройку (s,p,d), где s — номер сегмента, р — номер страницы в сегменте, d — смещение в странице.

Преобразование виртуального адреса в физический выполняется следующим образом. По номеру s из таблицы сегментов выбирается запись, соответствующая
запрашиваемому сегменту. По имеющейся в записи информации выполняется проверка прав доступа. Далее из записи выбирается адрес таблицы страниц данного
сегмента и по номеру р из таблицы страниц выбирается запись, соответствующая заданной странице. Из выбранной записи извлекается физический адрес начала страницы P, к которому добавляется смещение d в странице.
